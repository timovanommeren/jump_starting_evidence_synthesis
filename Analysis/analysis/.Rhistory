# assign to variables for easier access
simulation_long <- raw$simulation
simulation      <- processed$simulation
metadata        <- processed$meta
head(simulation)
summary(simulation)
#export summary data to latex format text file
descriptive_barchart(simulation, metadata)
#check the assumption of homogeneity of variance across conditions
ggplot(simulation, aes(x = condition, y = td)) +
geom_boxplot() +
geom_jitter(width = 0.1, alpha = .3)
# check the assumption of linearity between percentage and relevant records found
ggplot(simulation,
aes(x = percent_rel, y = td)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm",
aes(color = "linear"),
se = FALSE) +
geom_smooth(method = "lm",
formula = y ~ x + I(x^2),
aes(color = "quadratic"),
se = FALSE) +
labs(
title = "Percentage of relevant records vs. number of relevant records found",
x = "percentage of relevant records",
y = "Number of relevant records found in first 100 screened"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
panel.background = element_rect(fill = "white", color = NA),
plot.background  = element_rect(fill = "white", color = NA),
legend.background = element_rect(fill = "white", color = NA),
legend.key = element_rect(fill = "white", color = NA),
plot.margin = margin(10, 20, 10, 10)
)
# check the assumption of linearity between percentage and relevant records found
ggplot(simulation,
aes(x = records, y = td)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm",
aes(color = "linear"),
se = FALSE) +
geom_smooth(method = "lm",
formula = y ~ x + I(x^2),
aes(color = "quadratic"),
se = FALSE) +
labs(
title = "Total number of records vs. number of relevant records found",
x = "Percentage of relevant records",
y = "Number of relevant records found in first 100 screened"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
panel.background = element_rect(fill = "white", color = NA),
plot.background  = element_rect(fill = "white", color = NA),
legend.background = element_rect(fill = "white", color = NA),
legend.key = element_rect(fill = "white", color = NA),
plot.margin = margin(10, 20, 10, 10)
)
#set reference category for regression model
simulation <- simulation %>% mutate(condition = relevel(factor(condition), ref = "llm"))
model0 <- lmer(td ~ 1 + (1|dataset), REML = F, data = simulation)
summary(model0)
Intercept_variances = as.data.frame(VarCorr(model0))
ICC = Intercept_variances[Intercept_variances$grp == 'dataset','vcov'] / (Intercept_variances[Intercept_variances$grp == 'dataset','vcov'] + Intercept_variances[Intercept_variances$grp == 'Residual','vcov'])
print(ICC)
model1 <- lmer(td ~ condition  + (1|dataset), REML = F, data = simulation)
summary(model1)
anova(model1, model0)
simulation <- simulation %>%
mutate(
# indicator where llm parameters are actually defined
llm_active = (condition == "llm"),
# center within llm, set to 0 elsewhere (two-part coding)
n_abstracts_llm = ifelse(
llm_active,
n_abstracts - mean(n_abstracts[llm_active], na.rm = TRUE),
0
),
length_abstracts_llm = ifelse(
llm_active,
length_abstracts - mean(length_abstracts[llm_active], na.rm = TRUE),
0
),
llm_temperature_llm = ifelse(
llm_active,
llm_temperature - mean(llm_temperature[llm_active], na.rm = TRUE),
0
)
)
simulation$condition <- relevel(simulation$condition, ref = "llm")
model2 <- lmer(
td ~ condition +
n_abstracts_llm + length_abstracts_llm + llm_temperature_llm +
(1 | dataset),
REML = FALSE,
data = simulation
)
summary(model2)
anova(model2, model1)
anova(model2, model1)
summary(model2)
anova(model2, model1)
model3 <- lmer(
td ~ condition +
condition (n_abstracts_llm + length_abstracts_llm + llm_temperature_llm) +
(1 | dataset),
REML = FALSE,
data = simulation
)
model3 <- lmer(
td ~ condition +
condition * (n_abstracts_llm + length_abstracts_llm + llm_temperature_llm) +
(1 | dataset),
REML = FALSE,
data = simulation
)
summary(model3)
anova(model3, model2)
summary(model3)
model3 <- lmer(
td ~ condition +
condition * (n_abstracts_llm + length_abstracts_llm + llm_temperature_llm) +
(1 | dataset),
REML = FALSE,
data = simulation
)
simulation <- simulation %>%
mutate(
# indicator where llm parameters are actually defined
llm_active = (condition == "llm"),
# center within llm, set to 0 elsewhere (two-part coding)
n_abstracts_llm = ifelse(
llm_active,
n_abstracts - mean(n_abstracts[llm_active], na.rm = TRUE),
0
),
length_abstracts_llm = ifelse(
llm_active,
length_abstracts - mean(length_abstracts[llm_active], na.rm = TRUE),
0
),
llm_temperature_llm = ifelse(
llm_active,
llm_temperature - mean(llm_temperature[llm_active], na.rm = TRUE),
0
)
)
ggplot(simulation, aes(x = n_abstracts_llm, y = td, color = condition)) +
geom_point(alpha = 0.5) +
labs(title = "Recoded n_abstracts_llm vs td",
x = "Recoded n_abstracts_llm",
y = "td") +
theme_minimal()
# import simulation results and metadata (specify paths relative to project root)
raw <- load_simulation_data(data = "simulation_results/adding_NAs/all_simulation_results.csv",
metadata = "Analysis/percentage_relevant.csv")
# (1) transform simulation data to wide
# (2) adjust metadata column names, and,
# (3) add the number of records and percent_rel of relevant records from metadata to simulation data (these will serve as group-level predictors in multilevel model)
processed <- prepare_data(raw$simulation, raw$meta)
# assign to variables for easier access
simulation_long <- raw$simulation
simulation      <- processed$simulation
metadata        <- processed$meta
ggplot(simulation, aes(x = n_abstracts_llm, y = td, color = condition)) +
geom_point(alpha = 0.5) +
labs(title = "Recoded n_abstracts_llm vs td",
x = "Recoded n_abstracts_llm",
y = "td") +
theme_minimal()
ggplot(simulation, aes(x = n_abstracts, y = td, color = condition)) +
geom_point(alpha = 0.5) +
labs(title = "Recoded n_abstracts_llm vs td",
x = "Recoded n_abstracts_llm",
y = "td") +
theme_minimal()
simulation <- simulation %>%
mutate(
# indicator where llm parameters are actually defined
llm_active = (condition == "llm"),
# center within llm, set to 0 elsewhere (two-part coding)
n_abstracts_llm = ifelse(
llm_active,
n_abstracts - mean(n_abstracts[llm_active], na.rm = TRUE),
0
),
length_abstracts_llm = ifelse(
llm_active,
length_abstracts - mean(length_abstracts[llm_active], na.rm = TRUE),
0
),
llm_temperature_llm = ifelse(
llm_active,
llm_temperature - mean(llm_temperature[llm_active], na.rm = TRUE),
0
)
)
ggplot(simulation, aes(x = n_abstracts_llm, y = td, color = condition)) +
geom_point(alpha = 0.5) +
labs(title = "Recoded n_abstracts_llm vs td",
x = "Recoded n_abstracts_llm",
y = "td") +
theme_minimal()
simulation <- simulation %>%
mutate(
# indicator where llm parameters are actually defined
llm_active = (condition == "llm"),
# center within llm, set to 0 elsewhere (two-part coding)
n_abstracts_llm = ifelse(
llm_active,
n_abstracts - mean(n_abstracts[llm_active], na.rm = TRUE),
0
),
length_abstracts_llm = ifelse(
llm_active,
length_abstracts - mean(length_abstracts[llm_active], na.rm = TRUE),
0
),
llm_temperature_llm = ifelse(
llm_active,
llm_temperature - mean(llm_temperature[llm_active], na.rm = TRUE),
0
)
)
model2 <- lmer(td ~ condition + condition * (n_abstracts + length_abstracts + llm_temperature) + (1|dataset), REML = F, data = simulation)
simulation$condition <- as.factor(simulation$condition)
levels(simulation$condition)
model0 <- lmer(td ~ 1 + (1|dataset), REML = F, data = simulation)
summary(model0)
model1 <- lmer(td ~ condition + (1|dataset), REML = F, data = simulation)
summary(model1)
anova(model1, model0)
simulation$condition <- relevel(simulation$condition, ref = "llm")
model2 <- lmer(
td ~ condition +
n_abstracts_llm + length_abstracts_llm + llm_temperature_llm +
(1 | dataset),
REML = FALSE,
data = simulation
)
summary(model2)
anova(model2, model1)
model3 <- lmer(
td ~ condition +
condition * (n_abstracts_llm + length_abstracts_llm + llm_temperature_llm) +
(1 | dataset),
REML = FALSE,
data = simulation
)
summary(model3)
anova(model3, model2)
simulation$condition <- relevel(simulation$condition, ref = "llm")
model2 <- lmer(
td ~ condition +
n_abstracts_llm + length_abstracts_llm + llm_temperature_llm +
(1 | dataset),
REML = FALSE,
data = simulation
)
summary(model2)
anova(model2, model1)
simulation$condition <- relevel(simulation$condition, ref = "no_initialisation")
model2 <- lmer(
td ~ condition +
n_abstracts_llm + length_abstracts_llm + llm_temperature_llm +
(1 | dataset),
REML = FALSE,
data = simulation
)
summary(model2)
anova(model2, model1)
simulation$condition <- relevel(simulation$condition, ref = "llm")
model2 <- lmer(
td ~ condition +
n_abstracts_llm + length_abstracts_llm + llm_temperature_llm +
(1 | dataset),
REML = FALSE,
data = simulation
)
summary(model2)
anova(model2, model1)
model3 <- lmer(
td ~ condition +
condition * (n_abstracts_llm + length_abstracts_llm + llm_temperature_llm) +
(1 | dataset),
REML = FALSE,
data = simulation
)
summary(model3)
anova(model3, model2)
simulation_llm <- simulation %>% filter(condition == "llm")
model_llm_only <- lmer(
td ~
n_abstracts + length_abstracts + llm_temperature +
(1 | dataset),
REML = FALSE,
data = simulation_llm
)
simulation_no_llm <- simulation %>% filter(condition != "llm")
View(simulation_no_llm)
simulation_llm <- simulation %>% filter(condition == "llm")
model_llm_only <- lmer(
td ~
n_abstracts + length_abstracts + llm_temperature +
(1 | dataset),
REML = FALSE,
data = simulation_llm
)
simulation_no_llm <- simulation %>% filter(condition != "llm")
simulation_no_llm <- lmer(
td ~
(1 | dataset),
REML = FALSE,
data = simulation_llm
)
summary(model_llm_only)
summary(simulation_no_llm)
summary(model_llm_only)
summary(simulation_no_llm)
fixef(model_llm_only)["(Intercept)"]
# By subtracting the intercept of the no-llm model from the intercept of the llm-only model, we should get the same estimate as the conditionllm coefficient in model3
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_no_llm)["(Intercept)"]
fixef(model3)["conditionllm"]
# By subtracting the intercept of the no-llm model from the intercept of the llm-only model, we should get the same estimate as the conditionllm coefficient in model3
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_no_llm)["(Intercept)"]
simulation_no_llm <- simulation %>% filter(condition == "no_initialisation")
simulation_no_llm <- lmer(
td ~
(1 | dataset),
REML = FALSE,
data = simulation_llm
)
summary(model_llm_only)
summary(simulation_no_llm)
# By subtracting the intercept of the no-llm model from the intercept of the llm-only model, we should get the same estimate as the conditionllm coefficient in model3
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_no_llm)["(Intercept)"]
fixef(model3)["conditionllm"]
# By subtracting the intercept of the no-llm model from the intercept of the llm-only model, we should get the same estimate as the conditionllm coefficient in model3
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_no_llm)["(Intercept)"]
simulation_no_llm <- simulation %>% filter(condition == "no_initialisation")
simulation_no_llm <- lmer(
td ~
(1 | dataset),
REML = FALSE,
data = simulation_llm
)
summary(simulation_no_llm)
simulation_no_llm <- simulation %>% filter(condition == "no_initialisation")
simulation_no_llm <- lmer(
td ~
(1 | dataset),
REML = FALSE,
data = simulation_no_llm
)
summary(model_llm_only)
summary(simulation_no_llm)
# By subtracting the intercept of the no-llm model from the intercept of the llm-only model, we should get the same estimate as the conditionllm coefficient in model3
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_no_llm)["(Intercept)"]
simulation_no_llm <- simulation %>% filter(condition != "llm")
simulation_no_llm <- lmer(
td ~
(1 | dataset),
REML = FALSE,
data = simulation_no_llm
)
summary(simulation_no_llm)
# By subtracting the intercept of the no-llm model from the intercept of the llm-only model, we should get the same estimate as the conditionllm coefficient in model3
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_no_llm)["(Intercept)"]
fixef(model3)["conditionllm"]
fixef(model3)
fixef(model3)["(Intercept)"]
fixef(model3)["conditionrandom"]
simulation_no_llm <- simulation %>% filter(condition == "random")
simulation_no_llm <- simulation %>% filter(condition == "random")
simulation_no_llm <- lmer(
td ~
(1 | dataset),
REML = FALSE,
data = simulation_no_llm
)
summary(model_llm_only)
summary(simulation_no_llm)
# By subtracting the intercept of the no-llm model from the intercept of the llm-only model, we should get the same estimate as the conditionllm coefficient in model3
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_no_llm)["(Intercept)"]
fixef(model3)["conditionrandom"]
# By subtracting the intercept of the no-llm model from the intercept of the llm-only model, we should get the same estimate as the conditionllm coefficient in model3
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_no_llm)["(Intercept)"]
fixef(model3)["conditionrandom"]
summary(model_llm_only)
summary(simulation_no_llm)
# By subtracting the intercept of the no-llm model from the intercept of the llm-only model, we should get the same estimate as the conditionllm coefficient in model3
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_no_llm)["(Intercept)"]
fixef(model3)["conditionrandom"]
# By subtracting the intercept of the no-llm model from the intercept of the llm-only model, we should get the same estimate as the conditionllm coefficient in model3
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_no_llm)["(Intercept)"]
fixef(model3)["conditionrandom"]
summary(model_llm_only)
summary(simulation_no_llm)
simulation_llm <- simulation %>% filter(condition == "llm")
model_llm_only <- lmer(
td ~
n_abstracts + length_abstracts + llm_temperature +
(1 | dataset),
REML = FALSE,
data = simulation_llm
)
simulation_random <- simulation %>% filter(condition == "random")
simulation_random <- lmer(
td ~
(1 | dataset),
REML = FALSE,
data = simulation_random
)
simulation_no_init <- simulation %>% filter(condition == "no_initialisation")
simulation_no_init <- lmer(
td ~
(1 | dataset),
REML = FALSE,
data = simulation_no_init
)
# summary(model_llm_only)
# summary(simulation_no_llm)
#
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_random)["(Intercept)"]; fixef(model3)["conditionrandom"]
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_no_init)["(Intercept)"];
fixef(model3)["conditionno_initialisation"]
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_random)["(Intercept)"]; fixef(model3)["conditionrandom"]
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_no_init)["(Intercept)"];
fixef(model3)["conditionno_initialisation"]
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_no_init)["(Intercept)"];
fixef(model3)["conditionno_initialisation"]
fixef(model_llm_only)["(Intercept)"] - fixef(simulation_no_init)["(Intercept)"];
fixef(simulation_no_init)["(Intercept)"] - fixef(model_llm_only)["(Intercept)"];
fixef(model3)["conditionno_initialisation"]
# 1) Big two-part model (no random effects)
lm_big <- lm(
td ~ condition +
n_abstracts_llm + length_abstracts_llm + llm_temperature_llm,
data = simulation
)
# 2) Separate models
lm_llm <- lm(
td ~ n_abstracts + length_abstracts + llm_temperature,
data = subset(simulation, condition == "llm")
)
lm_random <- lm(
td ~ 1,
data = subset(simulation, condition == "random")
)
lm_noinit <- lm(
td ~ 1,
data = subset(simulation, condition == "no_initialisation")
)
all.equal(fitted(lm_big),
fitted(lm_llm_full_representation))  # where you rebuild eq.5 design
# 1) Big two-part model (no random effects)
lm_big <- lm(
td ~ condition +
n_abstracts_llm + length_abstracts_llm + llm_temperature_llm,
data = simulation
)
View(simulation)
fixef(lm_big)["(Intercept)"] - fixef(lm_random)["(Intercept)"]; fixef(lm_big)["conditionrandom"]
coef(lm_big)["(Intercept)"] + coef(lm_big)["conditionrandom"]; coef(lm_random)["(Intercept)"]
coef(lm_big)["(Intercept)"] + coef(lm_big)["conditionno_initialisation"]; coef(lm_noinit)["(Intercept)"]
coef(lm_big)["(Intercept)"] + coef(lm_big)["conditionno_initialisation"]; coef(lm_noinit)["(Intercept)"]
simulation$condition <- relevel(simulation$condition, ref = "llm")
model2 <- lmer(
td ~ condition +
n_abstracts_llm + length_abstracts_llm + llm_temperature_llm +
(1 | dataset),
REML = FALSE,
data = simulation
)
summary(model2)
model2 <- lmer(
td ~ condition +
n_abstracts + length_abstracts + llm_temperature +
(1 | dataset),
REML = FALSE,
data = simulation
)
simulation_llm <- simulation %>% filter(condition == "llm")
model2 <- lmer(
td ~
n_abstracts_llm + length_abstracts_llm + llm_temperature_llm +
(1 | dataset),
REML = FALSE,
data = simulation
)
model2 <- lmer(
td ~
n_abstracts_llm + length_abstracts_llm + llm_temperature_llm +
(1 | dataset),
REML = FALSE,
data = simulation_llm
)
summary(model2)
model2b <- lmer(
td ~
n_abstracts + length_abstracts + llm_temperature +
(1 | dataset),
REML = FALSE,
data = simulation_llm
)
summary(model2)
descriptive_barchart(simulation, metadata)
View(metadata)
